 <!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>MrIndyJones Analysis</title><script src="https://code.jquery.com/jquery-3.5.1.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script><link rel="stylesheet" href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css"><script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"></script><script src="https://cdn.jsdelivr.net/npm/chart.js"></script><style>body{font-family:sans-serif;background:#161512;color:#bababa;padding:10px;display:flex;flex-direction:column;align-items:center}.container{width:100%;max-width:1000px;background:#262421;padding:15px;border-radius:12px}#top-layout{display:flex;gap:15px;flex-wrap:wrap;justify-content:center}#board-wrapper{width:340px;text-align:center}#myBoard{width:100%;border:3px solid #3c3934}#chart-wrapper{flex:1;min-width:300px;background:#1a1917;height:250px;border-radius:8px;padding:5px}.main-btn{background:#45a049;color:#fff;border:none;padding:12px;border-radius:6px;font-weight:700;width:100%;margin-top:15px}#mobile-console{width:100%;height:120px;background:#000;color:#0f0;font-family:monospace;font-size:11px;padding:8px;margin-top:15px;overflow-y:scroll;border:1px solid #333;white-space:pre-wrap}table{width:100%;border-collapse:collapse;margin-top:15px;background:#1a1917;font-size:12px}th,td{padding:6px;border-bottom:1px solid #333;text-align:left}</style></head><body><div class="container"><div id="top-layout"><div id="board-wrapper"><div id="myBoard"></div><button style="margin-top:5px" onclick="board.flip()">Flip</button></div><div id="chart-wrapper"><canvas id="evalChart"></canvas></div></div><button class="main-btn" onclick="fetchAndAnalyze()">Analyze Game</button><p id="status" style="text-align:center;margin:10px 0;font-size:13px">Status: Idle</p><table><thead><tr><th>#</th><th>Move</th><th>Eval</th></tr></thead><tbody id="move-body"></tbody></table><div style="margin-top:20px;font-size:11px;color:#888">DEBUG LOG:</div><div id="mobile-console">-- Init --</div></div><script>const USERNAME='mrindyjones';let engine=null,board,evalChart,evalQueue=[];function log(m,e=false){const c=document.getElementById('mobile-console'),t=new Date().toLocaleTimeString();c.innerText+=`\n[${t}] ${e?'ERR: ':''}${m}`;c.scrollTop=c.scrollHeight}async function init(){if(engine)return;log("Loading engine...");try{const r=await fetch('https://cdn.jsdelivr.net/npm/stockfish.js@0.3.3/stockfish.js');if(!r.ok)throw new Error("CDN Error");const s=await r.text(),b=new Blob([s],{type:'application/javascript'});engine=new Worker(URL.createObjectURL(b));engine.onmessage=(e)=>{const l=typeof e.data==='string'?e.data:e.data.toString();if(l.includes('score cp')){const m=l.match(/score cp (-?\d+)/);if(m)update(parseInt(m[1])/100)}if(l.startsWith('bestmove')){evalQueue.shift();next()}};engine.postMessage('uci');log("Engine OK")}catch(err){log(err.message,true)}}function update(s){if(!evalQueue.length)return;const q=evalQueue[0];document.getElementById(`eval-${q.index}`).innerText=(s>0?'+':'')+s.toFixed(1);evalChart.data.labels.push(q.move);evalChart.data.datasets[0].data.push(s);evalChart.update()}function next(){if(evalQueue.length){const n=evalQueue[0];document.getElementById('status').innerText=`Analyzing ${n.index+1}...`;engine.postMessage(`position fen ${n.fen}`);engine.postMessage('go depth 10')}else{document.getElementById('status').innerText="Done"}}async function fetchAndAnalyze(){await init();log("Fetching Lichess...");try{const r=await fetch(`https://lichess.org/api/user/${USERNAME}/current-game?t=${Date.now()}`);if(r.status===204){log("No game found");return}const p=await r.text(),c=new Chess();c.load_pgn(p);board.position(c.fen());const h=c.history(),t=new Chess(),b=document.getElementById('move-body');b.innerHTML="";evalQueue=[];h.forEach((m,i)=>{t.move(m);const f=t.fen();b.insertRow().innerHTML=`<td>${i+1}</td><td>${m}</td><td id="eval-${i}">...</td>`;evalQueue.push({index:i,fen:f,move:m})});log(`Game loaded: ${h.length} moves`);next()}catch(err){log(err.message,true)}}$(document).ready(()=>{board=Chessboard('myBoard',{position:'start',pieceTheme:'https://chessboardjs.com/img/chesspieces/wikipedia/{piece}.png'});const ctx=document.getElementById('evalChart').getContext('2d');evalChart=new Chart(ctx,{type:'line',data:{labels:[],datasets:[{label:'Eval',data:[],borderColor:'#7fa650'}]},options:{responsive:true,maintainAspectRatio:false}})});</script></body></html>
